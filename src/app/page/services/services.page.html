<ion-header>
    <ion-toolbar color="primary">
        <ion-title style = "text-align: center;">Services</ion-title>
    </ion-toolbar>
</ion-header>
<ion-content>
    <div class = "search-barContainer">

        <ion-searchbar
            showCancelButton="focus"
            class = "search-bar"
            (ionInput) = "SearchBar($event)"
            [(ngModel)] = "searchbar">
        </ion-searchbar>

        <!-- (keydown) = "onKeyDown($event)" -->
        <ion-list id = "suggestions_list" position="floating" *ngIf = "New_Array?.length > 0">
            <!-- <ion-item>
                <ion-label (click) = "detail_id(array)">{{array?.name}}</ion-label>
            </ion-item> -->

            <ion-item id = "suggestions" *ngFor="let array of New_Array | slice : 0:5" (click) = "detail_id(array)">
                <ion-avatar slot="start" style = "border: 2px groove red;">
                  <img src="{{array?.photoURL}}">
                </ion-avatar>
                <ion-label class="ion-text-wrap">
                 <ion-text>
                    <h2>{{array?.name}}</h2>
                  </ion-text>

                  <!-- <p>Listen, I've had a pretty messed up day...</p> -->
                    <nav>
                        <ionic4-star-rating
                            activeIcon = "ios-star"
                            defaultIcon = "ios-star-outline"
                            activeColor = "red"
                            defaultColor = "#aaaaaa"
                            readonly="true"
                            fontSize = "15px"
                            rating = "{{array?.averageRating}}">
                        </ionic4-star-rating>
                    </nav>
                </ion-label>
              </ion-item>

              <!-- <ion-item *ngIf = "errorMessage != null">
                <ion-label>
                    {{errorMessage}}
                </ion-label>
            </ion-item> -->
        </ion-list>

        <ion-list id = "search_error_list" position="floating" *ngIf = "errorMessage">
            <ion-item id = "search_error_item" lines = "none">
                <ion-label>
                    <ion-icon ios="ios-search" md="md-search"></ion-icon>
                    <span>{{errorMessage}}</span>
                </ion-label>
            </ion-item>
        </ion-list>
    </div>

    <div class="recently" *ngIf = "sorted_array.length != 0">
        <h5>Most requested</h5>
        <ion-card class="scrolling-wrapper-flexbox">
            <ion-card-header class="card" (click) = "detail_id(serv)" *ngFor="let serv of sorted_array">
                <img src="{{serv?.photoURL}}" alt="photos" class="images" />
                <span class="text"><b>{{serv?.name}}</b></span>

                <div>
                    <nav>
                        <ionic4-star-rating
                            activeIcon = "ios-star"
                            defaultIcon = "ios-star-outline"
                            activeColor = "red"
                            defaultColor = "#aaaaaa"
                            readonly="true"
                            fontSize = "10px"
                            rating = "{{serv?.averageRating}}">
                        </ionic4-star-rating>
                    </nav>
                </div>
            </ion-card-header>

        </ion-card>
    </div>

    <div class="Electrical">
        <!-- services.id, services.requestsMade -->
        <h5 padding>Electrical & Materials</h5>
        <ion-card class="scrolling-wrapper-flexbox">
            <ion-card-header class="card" style="overflow:hidden;" (click) = "detail_id(services)" *ngFor="let services of ArrayServices" style="padding: 0px; " [style.backgroundImage]="'url(' + services.photoURL + ')'" style="background-position: center;background-repeat: no-repeat; background-size: cover;">
                <div class="shade"></div>
                <div text-center class="card-title">
                    <span id="title" style="font-size: 18px;">{{services.name}}</span>
                </div>

                <div style = "z-index: 12;">
                    <nav>
                        <ionic4-star-rating
                            activeIcon = "ios-star"
                            defaultIcon = "ios-star-outline"
                            activeColor = "red"
                            defaultColor = "#aaaaaa"
                            readonly="true"
                            fontSize = "15px"
                            rating = "{{services.averageRating}}">
                        </ionic4-star-rating>
                      </nav>
                </div>
                <div style = "color: white;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;">
                    <span>
                        {{services?.requestsMade}} requests
                    </span>
                </div>
            </ion-card-header>
        </ion-card>
    </div>

    <div class="Electrical">
        <!-- services.id, services.requestsMade -->
        <h5 padding>Plumbing</h5>
        <ion-card class="scrolling-wrapper-flexbox">
            <ion-card-header class="card" style="overflow:hidden;" (click) = "detail_id(services)" *ngFor="let services of PlumbingServices" style="padding: 0px; " [style.backgroundImage]="'url(' + services.photoURL + ')'" style="background-position: center;background-repeat: no-repeat; background-size: cover;">
                <div class="shade"></div>
                <div text-center class="card-title">
                    <span id="title" style="font-size: 18px;">{{services.name}}</span>
                </div>

                <div>
                    <nav>
                        <ionic4-star-rating
                            activeIcon = "ios-star"
                            defaultIcon = "ios-star-outline"
                            activeColor = "red"
                            defaultColor = "#aaaaaa"
                            readonly="true"
                            fontSize = "15px"
                            rating = "{{services.averageRating}}">
                        </ionic4-star-rating>
                      </nav>
                </div>
                <div style = "color: white;font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;">
                    <span>
                        {{services.requestsMade}} requests
                    </span>
                </div>
            </ion-card-header>
        </ion-card>
    </div>

    <!-- The commented code below might still be needed. Please don't remove! -->

    <!-- <div class="Plumbing">
        <h5 padding>Plumbing</h5>
        <ion-card class="scrolling-wrapper-flexbox">
            ​
            <ion-card-header class="card" style="overflow:hidden;" *ngFor="let services of PlumbingServices" (click) = "detail_id(services)" style="padding: 0px;">
                <img src="{{services.photoURL}}" alt="photos" />
                <span style="font-size: 18px;" class="text ">{{services.name}}</span><br>
                <div>
                    <nav style = "position: absolute;z-index: 12;">
                        <ionic4-star-rating
                            activeIcon = "ios-star"
                            defaultIcon = "ios-star-outline"
                            activeColor = "red"
                            defaultColor = "#aaaaaa"
                            readonly="true"
                            fontSize = "15px"
                            rating = "{{services.averageRating}}">
                        </ionic4-star-rating>
                      </nav>
                </div>

                <span style="font-size: 18px;" class="requests">
                    {{services.requestsMade}} requests
                </span>

            </ion-card-header>
        </ion-card>
    </div> -->

    <div class="ICT">
        <h5 padding>Information Technology</h5>
        <ion-card class="scrolling-wrapper-flexbox">
            ​
            <ion-card-header class="card" style="overflow:hidden;" *ngFor="let services of ArrayICTServices" (click) = "detail_id(services)" style="padding: 0px;">
                <img src="{{services.photoURL}}" alt="photos" />
                <span style="font-size: 18px;" class="text ">{{services.name}}</span><br>

                <div>
                    <nav>
                        <ionic4-star-rating
                            activeIcon = "ios-star"
                            defaultIcon = "ios-star-outline"
                            activeColor = "red"
                            defaultColor = "#aaaaaa"
                            readonly="true"
                            fontSize = "15px"
                            rating = "{{services.averageRating}}">
                        </ionic4-star-rating>
                    </nav>
                </div>
                <span style="font-size: 18px;" class="requests">
                    {{services.requestsMade}} requests
                </span>
            </ion-card-header>
        </ion-card>
    </div>

    <ion-fab vertical="bottom" horizontal="center" slot="fixed" class="fab">
        <ion-fab-button (click) = "redirect()">
            <ion-icon (click)="runs()" name="add"></ion-icon>
        </ion-fab-button>
    </ion-fab>
</ion-content>
